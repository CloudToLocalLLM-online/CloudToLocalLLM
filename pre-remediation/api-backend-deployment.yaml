apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "5"
    argocd.argoproj.io/tracking-id: api-backend:apps/Deployment:cloudtolocalllm/api-backend
    deployment.kubernetes.io/revision: "40"
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"argocd.argoproj.io/sync-wave":"5","argocd.argoproj.io/tracking-id":"api-backend:apps/Deployment:cloudtolocalllm/api-backend"},"labels":{"app":"api-backend"},"name":"api-backend","namespace":"cloudtolocalllm"},"spec":{"replicas":1,"selector":{"matchLabels":{"app":"api-backend"}},"strategy":{"rollingUpdate":{"maxSurge":1,"maxUnavailable":0},"type":"RollingUpdate"},"template":{"metadata":{"labels":{"app":"api-backend","tier":"backend"}},"spec":{"containers":[{"env":[{"name":"APP_MODE","value":"local"},{"name":"ENABLE_BILLING","value":"false"},{"name":"ENABLE_MULTI_TENANCY","value":"false"},{"name":"ADMIN_CENTER_ENABLED","value":"true"},{"name":"ENABLE_ADMIN_PAYMENTS","value":"false"},{"name":"NODE_ENV","valueFrom":{"configMapKeyRef":{"key":"NODE_ENV","name":"cloudtolocalllm-config"}}},{"name":"LOG_LEVEL","valueFrom":{"configMapKeyRef":{"key":"LOG_LEVEL","name":"cloudtolocalllm-config"}}},{"name":"CLIENT_LOG_DIR","valueFrom":{"configMapKeyRef":{"key":"CLIENT_LOG_DIR","name":"cloudtolocalllm-config"}}},{"name":"PORT","valueFrom":{"configMapKeyRef":{"key":"PORT","name":"cloudtolocalllm-config"}}},{"name":"DOMAIN","valueFrom":{"configMapKeyRef":{"key":"DOMAIN","name":"cloudtolocalllm-config"}}},{"name":"DB_TYPE","valueFrom":{"configMapKeyRef":{"key":"DB_TYPE","name":"cloudtolocalllm-config"}}},{"name":"DB_HOST","valueFrom":{"configMapKeyRef":{"key":"DB_HOST","name":"cloudtolocalllm-config"}}},{"name":"DB_PORT","valueFrom":{"configMapKeyRef":{"key":"DB_PORT","name":"cloudtolocalllm-config"}}},{"name":"DB_NAME","valueFrom":{"configMapKeyRef":{"key":"DB_NAME","name":"cloudtolocalllm-config"}}},{"name":"DB_USER","valueFrom":{"secretKeyRef":{"key":"postgres-user","name":"cloudtolocalllm-secrets"}}},{"name":"AUTH_DB_HOST","valueFrom":{"configMapKeyRef":{"key":"AUTH_DB_HOST","name":"cloudtolocalllm-config"}}},{"name":"AUTH_DB_PORT","valueFrom":{"configMapKeyRef":{"key":"AUTH_DB_PORT","name":"cloudtolocalllm-config"}}},{"name":"AUTH_DB_NAME","valueFrom":{"configMapKeyRef":{"key":"AUTH_DB_NAME","name":"cloudtolocalllm-config"}}},{"name":"AUTH_DB_USER","valueFrom":{"configMapKeyRef":{"key":"AUTH_DB_USER","name":"cloudtolocalllm-config"}}},{"name":"AUTH_DB_PASSWORD","valueFrom":{"secretKeyRef":{"key":"postgres-auth-password","name":"cloudtolocalllm-secrets"}}},{"name":"DB_PASSWORD","valueFrom":{"secretKeyRef":{"key":"postgres-password","name":"cloudtolocalllm-secrets"}}},{"name":"JWT_SECRET","valueFrom":{"secretKeyRef":{"key":"jwt-secret","name":"cloudtolocalllm-secrets"}}},{"name":"SUPABASE_JWT_SECRET","valueFrom":{"secretKeyRef":{"key":"supabase-jwt-secret","name":"cloudtolocalllm-secrets"}}},{"name":"SUPABASE_URL","valueFrom":{"secretKeyRef":{"key":"supabase-url","name":"cloudtolocalllm-secrets"}}},{"name":"AUTH0_ISSUER_URL","valueFrom":{"secretKeyRef":{"key":"auth0-issuer-url","name":"cloudtolocalllm-secrets"}}},{"name":"AUTH0_CLIENT_ID","valueFrom":{"secretKeyRef":{"key":"auth0-client-id","name":"cloudtolocalllm-secrets"}}},{"name":"AUTH0_CLIENT_SECRET","valueFrom":{"secretKeyRef":{"key":"auth0-client-secret","name":"cloudtolocalllm-secrets"}}},{"name":"AUTH0_AUDIENCE","valueFrom":{"secretKeyRef":{"key":"auth0-audience","name":"cloudtolocalllm-secrets"}}},{"name":"ADMIN_EMAIL","valueFrom":{"configMapKeyRef":{"key":"ADMIN_EMAIL","name":"cloudtolocalllm-config"}}},{"name":"DB_POOL_MAX","valueFrom":{"configMapKeyRef":{"key":"DB_POOL_MAX","name":"cloudtolocalllm-config"}}},{"name":"DB_POOL_IDLE_TIMEOUT","valueFrom":{"configMapKeyRef":{"key":"DB_POOL_IDLE_TIMEOUT","name":"cloudtolocalllm-config"}}},{"name":"DB_POOL_CONNECTION_TIMEOUT","valueFrom":{"configMapKeyRef":{"key":"DB_POOL_CONNECTION_TIMEOUT","name":"cloudtolocalllm-config"}}},{"name":"STRIPE_SECRET_KEY","valueFrom":{"secretKeyRef":{"key":"stripe-test-secret-key","name":"cloudtolocalllm-secrets"}}},{"name":"STRIPE_PUBLISHABLE_KEY","valueFrom":{"secretKeyRef":{"key":"stripe-test-publishable-key","name":"cloudtolocalllm-secrets"}}},{"name":"STRIPE_WEBHOOK_SECRET","valueFrom":{"secretKeyRef":{"key":"stripe-test-webhook-secret","name":"cloudtolocalllm-secrets"}}},{"name":"SENTRY_DSN","valueFrom":{"secretKeyRef":{"key":"sentry-dsn","name":"cloudtolocalllm-secrets","optional":true}}}],"image":"imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend","imagePullPolicy":"Always","livenessProbe":{"failureThreshold":3,"httpGet":{"path":"/health","port":8080},"initialDelaySeconds":60,"periodSeconds":10,"timeoutSeconds":5},"name":"api-backend","ports":[{"containerPort":8080,"name":"http"}],"readinessProbe":{"failureThreshold":3,"httpGet":{"path":"/health","port":8080},"initialDelaySeconds":10,"periodSeconds":5,"timeoutSeconds":3},"resources":{"limits":{"cpu":"250m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":false,"runAsNonRoot":true,"runAsUser":1001},"startupProbe":{"failureThreshold":30,"httpGet":{"path":"/health","port":8080},"initialDelaySeconds":5,"periodSeconds":5,"timeoutSeconds":3}}],"imagePullSecrets":[{"name":"regcred"}],"initContainers":[{"command":["sh","-c","until pg_isready -h postgres.cloudtolocalllm.svc.cluster.local -p 5432 -U postgres; do\n  echo \"Waiting for postgres...\"\n  sleep 2\ndone\n"],"image":"postgres:16-alpine","name":"wait-for-postgres"},{"command":["npm","run","db:migrate"],"env":[{"name":"NODE_ENV","valueFrom":{"configMapKeyRef":{"key":"NODE_ENV","name":"cloudtolocalllm-config"}}},{"name":"LOG_LEVEL","valueFrom":{"configMapKeyRef":{"key":"LOG_LEVEL","name":"cloudtolocalllm-config"}}},{"name":"CLIENT_LOG_DIR","valueFrom":{"configMapKeyRef":{"key":"CLIENT_LOG_DIR","name":"cloudtolocalllm-config"}}},{"name":"PORT","valueFrom":{"configMapKeyRef":{"key":"PORT","name":"cloudtolocalllm-config"}}},{"name":"DOMAIN","valueFrom":{"configMapKeyRef":{"key":"DOMAIN","name":"cloudtolocalllm-config"}}},{"name":"DB_TYPE","valueFrom":{"configMapKeyRef":{"key":"DB_TYPE","name":"cloudtolocalllm-config"}}},{"name":"DB_HOST","valueFrom":{"configMapKeyRef":{"key":"DB_HOST","name":"cloudtolocalllm-config"}}},{"name":"DB_PORT","valueFrom":{"configMapKeyRef":{"key":"DB_PORT","name":"cloudtolocalllm-config"}}},{"name":"DB_NAME","valueFrom":{"configMapKeyRef":{"key":"DB_NAME","name":"cloudtolocalllm-config"}}},{"name":"DB_USER","valueFrom":{"secretKeyRef":{"key":"postgres-user","name":"cloudtolocalllm-secrets"}}},{"name":"AUTH_DB_HOST","valueFrom":{"configMapKeyRef":{"key":"AUTH_DB_HOST","name":"cloudtolocalllm-config"}}},{"name":"AUTH_DB_PORT","valueFrom":{"configMapKeyRef":{"key":"AUTH_DB_PORT","name":"cloudtolocalllm-config"}}},{"name":"AUTH_DB_NAME","valueFrom":{"configMapKeyRef":{"key":"AUTH_DB_NAME","name":"cloudtolocalllm-config"}}},{"name":"AUTH_DB_USER","valueFrom":{"configMapKeyRef":{"key":"AUTH_DB_USER","name":"cloudtolocalllm-config"}}},{"name":"AUTH_DB_PASSWORD","valueFrom":{"secretKeyRef":{"key":"postgres-auth-password","name":"cloudtolocalllm-secrets"}}},{"name":"DB_PASSWORD","valueFrom":{"secretKeyRef":{"key":"postgres-password","name":"cloudtolocalllm-secrets"}}},{"name":"JWT_SECRET","valueFrom":{"secretKeyRef":{"key":"jwt-secret","name":"cloudtolocalllm-secrets"}}},{"name":"SUPABASE_JWT_SECRET","valueFrom":{"secretKeyRef":{"key":"supabase-jwt-secret","name":"cloudtolocalllm-secrets"}}},{"name":"SUPABASE_URL","valueFrom":{"secretKeyRef":{"key":"supabase-url","name":"cloudtolocalllm-secrets"}}},{"name":"AUTH0_ISSUER_URL","valueFrom":{"secretKeyRef":{"key":"auth0-issuer-url","name":"cloudtolocalllm-secrets"}}},{"name":"AUTH0_CLIENT_ID","valueFrom":{"secretKeyRef":{"key":"auth0-client-id","name":"cloudtolocalllm-secrets"}}},{"name":"AUTH0_CLIENT_SECRET","valueFrom":{"secretKeyRef":{"key":"auth0-client-secret","name":"cloudtolocalllm-secrets"}}},{"name":"AUTH0_AUDIENCE","valueFrom":{"secretKeyRef":{"key":"auth0-audience","name":"cloudtolocalllm-secrets"}}},{"name":"ADMIN_EMAIL","valueFrom":{"configMapKeyRef":{"key":"ADMIN_EMAIL","name":"cloudtolocalllm-config"}}},{"name":"DB_POOL_MAX","valueFrom":{"configMapKeyRef":{"key":"DB_POOL_MAX","name":"cloudtolocalllm-config"}}},{"name":"DB_POOL_IDLE_TIMEOUT","valueFrom":{"configMapKeyRef":{"key":"DB_POOL_IDLE_TIMEOUT","name":"cloudtolocalllm-config"}}},{"name":"DB_POOL_CONNECTION_TIMEOUT","valueFrom":{"configMapKeyRef":{"key":"DB_POOL_CONNECTION_TIMEOUT","name":"cloudtolocalllm-config"}}},{"name":"STRIPE_SECRET_KEY","valueFrom":{"secretKeyRef":{"key":"stripe-test-secret-key","name":"cloudtolocalllm-secrets"}}},{"name":"STRIPE_PUBLISHABLE_KEY","valueFrom":{"secretKeyRef":{"key":"stripe-test-publishable-key","name":"cloudtolocalllm-secrets"}}},{"name":"STRIPE_WEBHOOK_SECRET","valueFrom":{"secretKeyRef":{"key":"stripe-test-webhook-secret","name":"cloudtolocalllm-secrets"}}},{"name":"SENTRY_DSN","valueFrom":{"secretKeyRef":{"key":"sentry-dsn","name":"cloudtolocalllm-secrets","optional":true}}}],"image":"imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend","imagePullPolicy":"Always","name":"db-migrate","securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":false,"runAsNonRoot":true,"runAsUser":1001}}],"securityContext":{"fsGroup":1001,"runAsNonRoot":true,"runAsUser":1001},"serviceAccountName":"api-backend-sa"}}},"status":{"availableReplicas":1,"conditions":[{"lastTransitionTime":"2025-12-21T18:17:34Z","lastUpdateTime":"2025-12-21T18:17:34Z","message":"Deployment has minimum availability.","reason":"MinimumReplicasAvailable","status":"True","type":"Available"},{"lastTransitionTime":"2025-12-22T03:42:11Z","lastUpdateTime":"2025-12-22T03:42:12Z","message":"ReplicaSet \"api-backend-8675fb6f49\" is progressing.","reason":"ReplicaSetUpdated","status":"True","type":"Progressing"}],"observedGeneration":39,"readyReplicas":1,"replicas":2,"unavailableReplicas":1,"updatedReplicas":1}}
  creationTimestamp: "2025-12-21T14:56:33Z"
  generation: 40
  labels:
    app: api-backend
  name: api-backend
  namespace: cloudtolocalllm
  resourceVersion: "7903833"
  uid: a92f8ac1-9884-41f7-b9ab-bd1094683c4d
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: api-backend
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: api-backend
        tier: backend
    spec:
      containers:
      - env:
        - name: APP_MODE
          value: local
        - name: ENABLE_BILLING
          value: "false"
        - name: ENABLE_MULTI_TENANCY
          value: "false"
        - name: ADMIN_CENTER_ENABLED
          value: "true"
        - name: ENABLE_ADMIN_PAYMENTS
          value: "false"
        - name: NODE_ENV
          valueFrom:
            configMapKeyRef:
              key: NODE_ENV
              name: cloudtolocalllm-config
        - name: LOG_LEVEL
          valueFrom:
            configMapKeyRef:
              key: LOG_LEVEL
              name: cloudtolocalllm-config
        - name: CLIENT_LOG_DIR
          valueFrom:
            configMapKeyRef:
              key: CLIENT_LOG_DIR
              name: cloudtolocalllm-config
        - name: PORT
          valueFrom:
            configMapKeyRef:
              key: PORT
              name: cloudtolocalllm-config
        - name: DOMAIN
          valueFrom:
            configMapKeyRef:
              key: DOMAIN
              name: cloudtolocalllm-config
        - name: DB_TYPE
          valueFrom:
            configMapKeyRef:
              key: DB_TYPE
              name: cloudtolocalllm-config
        - name: DB_HOST
          valueFrom:
            configMapKeyRef:
              key: DB_HOST
              name: cloudtolocalllm-config
        - name: DB_PORT
          valueFrom:
            configMapKeyRef:
              key: DB_PORT
              name: cloudtolocalllm-config
        - name: DB_NAME
          valueFrom:
            configMapKeyRef:
              key: DB_NAME
              name: cloudtolocalllm-config
        - name: DB_USER
          valueFrom:
            secretKeyRef:
              key: postgres-user
              name: cloudtolocalllm-secrets
        - name: AUTH_DB_HOST
          valueFrom:
            configMapKeyRef:
              key: AUTH_DB_HOST
              name: cloudtolocalllm-config
        - name: AUTH_DB_PORT
          valueFrom:
            configMapKeyRef:
              key: AUTH_DB_PORT
              name: cloudtolocalllm-config
        - name: AUTH_DB_NAME
          valueFrom:
            configMapKeyRef:
              key: AUTH_DB_NAME
              name: cloudtolocalllm-config
        - name: AUTH_DB_USER
          valueFrom:
            configMapKeyRef:
              key: AUTH_DB_USER
              name: cloudtolocalllm-config
        - name: AUTH_DB_PASSWORD
          valueFrom:
            secretKeyRef:
              key: postgres-auth-password
              name: cloudtolocalllm-secrets
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              key: postgres-password
              name: cloudtolocalllm-secrets
        - name: JWT_SECRET
          valueFrom:
            secretKeyRef:
              key: jwt-secret
              name: cloudtolocalllm-secrets
        - name: SUPABASE_JWT_SECRET
          valueFrom:
            secretKeyRef:
              key: supabase-jwt-secret
              name: cloudtolocalllm-secrets
        - name: SUPABASE_URL
          valueFrom:
            secretKeyRef:
              key: supabase-url
              name: cloudtolocalllm-secrets
        - name: AUTH0_ISSUER_URL
          valueFrom:
            secretKeyRef:
              key: auth0-issuer-url
              name: cloudtolocalllm-secrets
        - name: AUTH0_CLIENT_ID
          valueFrom:
            secretKeyRef:
              key: auth0-client-id
              name: cloudtolocalllm-secrets
        - name: AUTH0_CLIENT_SECRET
          valueFrom:
            secretKeyRef:
              key: auth0-client-secret
              name: cloudtolocalllm-secrets
        - name: AUTH0_AUDIENCE
          valueFrom:
            secretKeyRef:
              key: auth0-audience
              name: cloudtolocalllm-secrets
        - name: ADMIN_EMAIL
          valueFrom:
            configMapKeyRef:
              key: ADMIN_EMAIL
              name: cloudtolocalllm-config
        - name: DB_POOL_MAX
          valueFrom:
            configMapKeyRef:
              key: DB_POOL_MAX
              name: cloudtolocalllm-config
        - name: DB_POOL_IDLE_TIMEOUT
          valueFrom:
            configMapKeyRef:
              key: DB_POOL_IDLE_TIMEOUT
              name: cloudtolocalllm-config
        - name: DB_POOL_CONNECTION_TIMEOUT
          valueFrom:
            configMapKeyRef:
              key: DB_POOL_CONNECTION_TIMEOUT
              name: cloudtolocalllm-config
        - name: STRIPE_SECRET_KEY
          valueFrom:
            secretKeyRef:
              key: stripe-test-secret-key
              name: cloudtolocalllm-secrets
        - name: STRIPE_PUBLISHABLE_KEY
          valueFrom:
            secretKeyRef:
              key: stripe-test-publishable-key
              name: cloudtolocalllm-secrets
        - name: STRIPE_WEBHOOK_SECRET
          valueFrom:
            secretKeyRef:
              key: stripe-test-webhook-secret
              name: cloudtolocalllm-secrets
        - name: SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: sentry-dsn
              name: cloudtolocalllm-secrets
              optional: true
        image: imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend
        imagePullPolicy: Always
        livenessProbe:
          failureThreshold: 3
          httpGet:
            path: /health
            port: 8080
            scheme: HTTP
          initialDelaySeconds: 60
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        name: api-backend
        ports:
        - containerPort: 8080
          name: http
          protocol: TCP
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /health
            port: 8080
            scheme: HTTP
          initialDelaySeconds: 10
          periodSeconds: 5
          successThreshold: 1
          timeoutSeconds: 3
        resources:
          limits:
            cpu: 250m
            memory: 512Mi
          requests:
            cpu: 100m
            memory: 128Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: false
          runAsNonRoot: true
          runAsUser: 1001
        startupProbe:
          failureThreshold: 30
          httpGet:
            path: /health
            port: 8080
            scheme: HTTP
          initialDelaySeconds: 5
          periodSeconds: 5
          successThreshold: 1
          timeoutSeconds: 3
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      imagePullSecrets:
      - name: regcred
      initContainers:
      - command:
        - sh
        - -c
        - |
          until pg_isready -h postgres.cloudtolocalllm.svc.cluster.local -p 5432 -U postgres; do
            echo "Waiting for postgres..."
            sleep 2
          done
        image: postgres:16-alpine
        imagePullPolicy: IfNotPresent
        name: wait-for-postgres
        resources: {}
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      - command:
        - npm
        - run
        - db:migrate
        env:
        - name: NODE_ENV
          valueFrom:
            configMapKeyRef:
              key: NODE_ENV
              name: cloudtolocalllm-config
        - name: LOG_LEVEL
          valueFrom:
            configMapKeyRef:
              key: LOG_LEVEL
              name: cloudtolocalllm-config
        - name: CLIENT_LOG_DIR
          valueFrom:
            configMapKeyRef:
              key: CLIENT_LOG_DIR
              name: cloudtolocalllm-config
        - name: PORT
          valueFrom:
            configMapKeyRef:
              key: PORT
              name: cloudtolocalllm-config
        - name: DOMAIN
          valueFrom:
            configMapKeyRef:
              key: DOMAIN
              name: cloudtolocalllm-config
        - name: DB_TYPE
          valueFrom:
            configMapKeyRef:
              key: DB_TYPE
              name: cloudtolocalllm-config
        - name: DB_HOST
          valueFrom:
            configMapKeyRef:
              key: DB_HOST
              name: cloudtolocalllm-config
        - name: DB_PORT
          valueFrom:
            configMapKeyRef:
              key: DB_PORT
              name: cloudtolocalllm-config
        - name: DB_NAME
          valueFrom:
            configMapKeyRef:
              key: DB_NAME
              name: cloudtolocalllm-config
        - name: DB_USER
          valueFrom:
            secretKeyRef:
              key: postgres-user
              name: cloudtolocalllm-secrets
        - name: AUTH_DB_HOST
          valueFrom:
            configMapKeyRef:
              key: AUTH_DB_HOST
              name: cloudtolocalllm-config
        - name: AUTH_DB_PORT
          valueFrom:
            configMapKeyRef:
              key: AUTH_DB_PORT
              name: cloudtolocalllm-config
        - name: AUTH_DB_NAME
          valueFrom:
            configMapKeyRef:
              key: AUTH_DB_NAME
              name: cloudtolocalllm-config
        - name: AUTH_DB_USER
          valueFrom:
            configMapKeyRef:
              key: AUTH_DB_USER
              name: cloudtolocalllm-config
        - name: AUTH_DB_PASSWORD
          valueFrom:
            secretKeyRef:
              key: postgres-auth-password
              name: cloudtolocalllm-secrets
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              key: postgres-password
              name: cloudtolocalllm-secrets
        - name: JWT_SECRET
          valueFrom:
            secretKeyRef:
              key: jwt-secret
              name: cloudtolocalllm-secrets
        - name: SUPABASE_JWT_SECRET
          valueFrom:
            secretKeyRef:
              key: supabase-jwt-secret
              name: cloudtolocalllm-secrets
        - name: SUPABASE_URL
          valueFrom:
            secretKeyRef:
              key: supabase-url
              name: cloudtolocalllm-secrets
        - name: AUTH0_ISSUER_URL
          valueFrom:
            secretKeyRef:
              key: auth0-issuer-url
              name: cloudtolocalllm-secrets
        - name: AUTH0_CLIENT_ID
          valueFrom:
            secretKeyRef:
              key: auth0-client-id
              name: cloudtolocalllm-secrets
        - name: AUTH0_CLIENT_SECRET
          valueFrom:
            secretKeyRef:
              key: auth0-client-secret
              name: cloudtolocalllm-secrets
        - name: AUTH0_AUDIENCE
          valueFrom:
            secretKeyRef:
              key: auth0-audience
              name: cloudtolocalllm-secrets
        - name: ADMIN_EMAIL
          valueFrom:
            configMapKeyRef:
              key: ADMIN_EMAIL
              name: cloudtolocalllm-config
        - name: DB_POOL_MAX
          valueFrom:
            configMapKeyRef:
              key: DB_POOL_MAX
              name: cloudtolocalllm-config
        - name: DB_POOL_IDLE_TIMEOUT
          valueFrom:
            configMapKeyRef:
              key: DB_POOL_IDLE_TIMEOUT
              name: cloudtolocalllm-config
        - name: DB_POOL_CONNECTION_TIMEOUT
          valueFrom:
            configMapKeyRef:
              key: DB_POOL_CONNECTION_TIMEOUT
              name: cloudtolocalllm-config
        - name: STRIPE_SECRET_KEY
          valueFrom:
            secretKeyRef:
              key: stripe-test-secret-key
              name: cloudtolocalllm-secrets
        - name: STRIPE_PUBLISHABLE_KEY
          valueFrom:
            secretKeyRef:
              key: stripe-test-publishable-key
              name: cloudtolocalllm-secrets
        - name: STRIPE_WEBHOOK_SECRET
          valueFrom:
            secretKeyRef:
              key: stripe-test-webhook-secret
              name: cloudtolocalllm-secrets
        - name: SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: sentry-dsn
              name: cloudtolocalllm-secrets
              optional: true
        image: imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend
        imagePullPolicy: Always
        name: db-migrate
        resources: {}
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: false
          runAsNonRoot: true
          runAsUser: 1001
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        fsGroup: 1001
        runAsNonRoot: true
        runAsUser: 1001
      serviceAccount: api-backend-sa
      serviceAccountName: api-backend-sa
      terminationGracePeriodSeconds: 30
status:
  conditions:
  - lastTransitionTime: "2025-12-22T03:52:14Z"
    lastUpdateTime: "2025-12-22T03:52:14Z"
    message: ReplicaSet "api-backend-64cd97cb75" has timed out progressing.
    reason: ProgressDeadlineExceeded
    status: "False"
    type: Progressing
  - lastTransitionTime: "2025-12-24T03:45:33Z"
    lastUpdateTime: "2025-12-24T03:45:33Z"
    message: Deployment does not have minimum availability.
    reason: MinimumReplicasUnavailable
    status: "False"
    type: Available
  observedGeneration: 40
  replicas: 2
  unavailableReplicas: 2
  updatedReplicas: 1
