apiVersion: v1
items:
- apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: "2025-12-22T03:42:13Z"
    generateName: api-backend-64cd97cb75-
    labels:
      app: api-backend
      pod-template-hash: 64cd97cb75
      tier: backend
    name: api-backend-64cd97cb75-x42ms
    namespace: cloudtolocalllm
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: api-backend-64cd97cb75
      uid: 100db630-27df-4a86-84b5-af304e922a14
    resourceVersion: "8175645"
    uid: 855c4419-4c89-478a-b4ed-63e07904683f
  spec:
    containers:
    - env:
      - name: APP_MODE
        value: local
      - name: ENABLE_BILLING
        value: "false"
      - name: ENABLE_MULTI_TENANCY
        value: "false"
      - name: ADMIN_CENTER_ENABLED
        value: "true"
      - name: ENABLE_ADMIN_PAYMENTS
        value: "false"
      - name: NODE_ENV
        valueFrom:
          configMapKeyRef:
            key: NODE_ENV
            name: cloudtolocalllm-config
      - name: LOG_LEVEL
        valueFrom:
          configMapKeyRef:
            key: LOG_LEVEL
            name: cloudtolocalllm-config
      - name: CLIENT_LOG_DIR
        valueFrom:
          configMapKeyRef:
            key: CLIENT_LOG_DIR
            name: cloudtolocalllm-config
      - name: PORT
        valueFrom:
          configMapKeyRef:
            key: PORT
            name: cloudtolocalllm-config
      - name: DOMAIN
        valueFrom:
          configMapKeyRef:
            key: DOMAIN
            name: cloudtolocalllm-config
      - name: DB_TYPE
        valueFrom:
          configMapKeyRef:
            key: DB_TYPE
            name: cloudtolocalllm-config
      - name: DB_HOST
        valueFrom:
          configMapKeyRef:
            key: DB_HOST
            name: cloudtolocalllm-config
      - name: DB_PORT
        valueFrom:
          configMapKeyRef:
            key: DB_PORT
            name: cloudtolocalllm-config
      - name: DB_NAME
        valueFrom:
          configMapKeyRef:
            key: DB_NAME
            name: cloudtolocalllm-config
      - name: DB_USER
        valueFrom:
          secretKeyRef:
            key: postgres-user
            name: cloudtolocalllm-secrets
      - name: AUTH_DB_HOST
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_HOST
            name: cloudtolocalllm-config
      - name: AUTH_DB_PORT
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_PORT
            name: cloudtolocalllm-config
      - name: AUTH_DB_NAME
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_NAME
            name: cloudtolocalllm-config
      - name: AUTH_DB_USER
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_USER
            name: cloudtolocalllm-config
      - name: AUTH_DB_PASSWORD
        valueFrom:
          secretKeyRef:
            key: postgres-auth-password
            name: cloudtolocalllm-secrets
      - name: DB_PASSWORD
        valueFrom:
          secretKeyRef:
            key: postgres-password
            name: cloudtolocalllm-secrets
      - name: JWT_SECRET
        valueFrom:
          secretKeyRef:
            key: jwt-secret
            name: cloudtolocalllm-secrets
      - name: SUPABASE_JWT_SECRET
        valueFrom:
          secretKeyRef:
            key: supabase-jwt-secret
            name: cloudtolocalllm-secrets
      - name: SUPABASE_URL
        valueFrom:
          secretKeyRef:
            key: supabase-url
            name: cloudtolocalllm-secrets
      - name: AUTH0_ISSUER_URL
        valueFrom:
          secretKeyRef:
            key: auth0-issuer-url
            name: cloudtolocalllm-secrets
      - name: AUTH0_CLIENT_ID
        valueFrom:
          secretKeyRef:
            key: auth0-client-id
            name: cloudtolocalllm-secrets
      - name: AUTH0_CLIENT_SECRET
        valueFrom:
          secretKeyRef:
            key: auth0-client-secret
            name: cloudtolocalllm-secrets
      - name: AUTH0_AUDIENCE
        valueFrom:
          secretKeyRef:
            key: auth0-audience
            name: cloudtolocalllm-secrets
      - name: ADMIN_EMAIL
        valueFrom:
          configMapKeyRef:
            key: ADMIN_EMAIL
            name: cloudtolocalllm-config
      - name: DB_POOL_MAX
        valueFrom:
          configMapKeyRef:
            key: DB_POOL_MAX
            name: cloudtolocalllm-config
      - name: DB_POOL_IDLE_TIMEOUT
        valueFrom:
          configMapKeyRef:
            key: DB_POOL_IDLE_TIMEOUT
            name: cloudtolocalllm-config
      - name: DB_POOL_CONNECTION_TIMEOUT
        valueFrom:
          configMapKeyRef:
            key: DB_POOL_CONNECTION_TIMEOUT
            name: cloudtolocalllm-config
      - name: STRIPE_SECRET_KEY
        valueFrom:
          secretKeyRef:
            key: stripe-test-secret-key
            name: cloudtolocalllm-secrets
      - name: STRIPE_PUBLISHABLE_KEY
        valueFrom:
          secretKeyRef:
            key: stripe-test-publishable-key
            name: cloudtolocalllm-secrets
      - name: STRIPE_WEBHOOK_SECRET
        valueFrom:
          secretKeyRef:
            key: stripe-test-webhook-secret
            name: cloudtolocalllm-secrets
      - name: SENTRY_DSN
        valueFrom:
          secretKeyRef:
            key: sentry-dsn
            name: cloudtolocalllm-secrets
            optional: true
      image: imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend
      imagePullPolicy: Always
      livenessProbe:
        failureThreshold: 3
        httpGet:
          path: /health
          port: 8080
          scheme: HTTP
        initialDelaySeconds: 60
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 5
      name: api-backend
      ports:
      - containerPort: 8080
        name: http
        protocol: TCP
      readinessProbe:
        failureThreshold: 3
        httpGet:
          path: /health
          port: 8080
          scheme: HTTP
        initialDelaySeconds: 10
        periodSeconds: 5
        successThreshold: 1
        timeoutSeconds: 3
      resources:
        limits:
          cpu: 250m
          memory: 512Mi
        requests:
          cpu: 100m
          memory: 128Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: false
        runAsNonRoot: true
        runAsUser: 1001
      startupProbe:
        failureThreshold: 30
        httpGet:
          path: /health
          port: 8080
          scheme: HTTP
        initialDelaySeconds: 5
        periodSeconds: 5
        successThreshold: 1
        timeoutSeconds: 3
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-pqr28
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    imagePullSecrets:
    - name: regcred
    initContainers:
    - command:
      - sh
      - -c
      - |
        until pg_isready -h postgres.cloudtolocalllm.svc.cluster.local -p 5432 -U postgres; do
          echo "Waiting for postgres..."
          sleep 2
        done
      image: postgres:16-alpine
      imagePullPolicy: IfNotPresent
      name: wait-for-postgres
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-pqr28
        readOnly: true
    - command:
      - npm
      - run
      - db:migrate
      env:
      - name: NODE_ENV
        valueFrom:
          configMapKeyRef:
            key: NODE_ENV
            name: cloudtolocalllm-config
      - name: LOG_LEVEL
        valueFrom:
          configMapKeyRef:
            key: LOG_LEVEL
            name: cloudtolocalllm-config
      - name: CLIENT_LOG_DIR
        valueFrom:
          configMapKeyRef:
            key: CLIENT_LOG_DIR
            name: cloudtolocalllm-config
      - name: PORT
        valueFrom:
          configMapKeyRef:
            key: PORT
            name: cloudtolocalllm-config
      - name: DOMAIN
        valueFrom:
          configMapKeyRef:
            key: DOMAIN
            name: cloudtolocalllm-config
      - name: DB_TYPE
        valueFrom:
          configMapKeyRef:
            key: DB_TYPE
            name: cloudtolocalllm-config
      - name: DB_HOST
        valueFrom:
          configMapKeyRef:
            key: DB_HOST
            name: cloudtolocalllm-config
      - name: DB_PORT
        valueFrom:
          configMapKeyRef:
            key: DB_PORT
            name: cloudtolocalllm-config
      - name: DB_NAME
        valueFrom:
          configMapKeyRef:
            key: DB_NAME
            name: cloudtolocalllm-config
      - name: DB_USER
        valueFrom:
          secretKeyRef:
            key: postgres-user
            name: cloudtolocalllm-secrets
      - name: AUTH_DB_HOST
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_HOST
            name: cloudtolocalllm-config
      - name: AUTH_DB_PORT
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_PORT
            name: cloudtolocalllm-config
      - name: AUTH_DB_NAME
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_NAME
            name: cloudtolocalllm-config
      - name: AUTH_DB_USER
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_USER
            name: cloudtolocalllm-config
      - name: AUTH_DB_PASSWORD
        valueFrom:
          secretKeyRef:
            key: postgres-auth-password
            name: cloudtolocalllm-secrets
      - name: DB_PASSWORD
        valueFrom:
          secretKeyRef:
            key: postgres-password
            name: cloudtolocalllm-secrets
      - name: JWT_SECRET
        valueFrom:
          secretKeyRef:
            key: jwt-secret
            name: cloudtolocalllm-secrets
      - name: SUPABASE_JWT_SECRET
        valueFrom:
          secretKeyRef:
            key: supabase-jwt-secret
            name: cloudtolocalllm-secrets
      - name: SUPABASE_URL
        valueFrom:
          secretKeyRef:
            key: supabase-url
            name: cloudtolocalllm-secrets
      - name: AUTH0_ISSUER_URL
        valueFrom:
          secretKeyRef:
            key: auth0-issuer-url
            name: cloudtolocalllm-secrets
      - name: AUTH0_CLIENT_ID
        valueFrom:
          secretKeyRef:
            key: auth0-client-id
            name: cloudtolocalllm-secrets
      - name: AUTH0_CLIENT_SECRET
        valueFrom:
          secretKeyRef:
            key: auth0-client-secret
            name: cloudtolocalllm-secrets
      - name: AUTH0_AUDIENCE
        valueFrom:
          secretKeyRef:
            key: auth0-audience
            name: cloudtolocalllm-secrets
      - name: ADMIN_EMAIL
        valueFrom:
          configMapKeyRef:
            key: ADMIN_EMAIL
            name: cloudtolocalllm-config
      - name: DB_POOL_MAX
        valueFrom:
          configMapKeyRef:
            key: DB_POOL_MAX
            name: cloudtolocalllm-config
      - name: DB_POOL_IDLE_TIMEOUT
        valueFrom:
          configMapKeyRef:
            key: DB_POOL_IDLE_TIMEOUT
            name: cloudtolocalllm-config
      - name: DB_POOL_CONNECTION_TIMEOUT
        valueFrom:
          configMapKeyRef:
            key: DB_POOL_CONNECTION_TIMEOUT
            name: cloudtolocalllm-config
      - name: STRIPE_SECRET_KEY
        valueFrom:
          secretKeyRef:
            key: stripe-test-secret-key
            name: cloudtolocalllm-secrets
      - name: STRIPE_PUBLISHABLE_KEY
        valueFrom:
          secretKeyRef:
            key: stripe-test-publishable-key
            name: cloudtolocalllm-secrets
      - name: STRIPE_WEBHOOK_SECRET
        valueFrom:
          secretKeyRef:
            key: stripe-test-webhook-secret
            name: cloudtolocalllm-secrets
      - name: SENTRY_DSN
        valueFrom:
          secretKeyRef:
            key: sentry-dsn
            name: cloudtolocalllm-secrets
            optional: true
      image: imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend
      imagePullPolicy: Always
      name: db-migrate
      resources: {}
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: false
        runAsNonRoot: true
        runAsUser: 1001
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-pqr28
        readOnly: true
    nodeName: aks-nodepool1-20736382-vmss000000
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      fsGroup: 1001
      runAsNonRoot: true
      runAsUser: 1001
    serviceAccount: api-backend-sa
    serviceAccountName: api-backend-sa
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    - effect: NoSchedule
      key: node.kubernetes.io/memory-pressure
      operator: Exists
    volumes:
    - name: kube-api-access-pqr28
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-22T03:42:14Z"
      status: "True"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-22T03:42:13Z"
      message: 'containers with incomplete status: [db-migrate]'
      reason: ContainersNotInitialized
      status: "False"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-22T03:42:13Z"
      message: 'containers with unready status: [api-backend]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-22T03:42:13Z"
      message: 'containers with unready status: [api-backend]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-22T03:42:13Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - image: imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend
      imageID: ""
      lastState: {}
      name: api-backend
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
      volumeMounts:
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-pqr28
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.224.0.4
    hostIPs:
    - ip: 10.224.0.4
    initContainerStatuses:
    - containerID: containerd://fc0400cd5a17586d65c35a4d7dda3f31e469a0567f674351648682e7ba6a01ed
      image: docker.io/library/postgres:16-alpine
      imageID: docker.io/library/postgres@sha256:6a388fba16e2a94d6d92bc3c435cdc2e20145add88547615b3d8fa545d703afe
      lastState: {}
      name: wait-for-postgres
      ready: true
      restartCount: 0
      started: false
      state:
        terminated:
          containerID: containerd://fc0400cd5a17586d65c35a4d7dda3f31e469a0567f674351648682e7ba6a01ed
          exitCode: 0
          finishedAt: "2025-12-22T03:42:14Z"
          reason: Completed
          startedAt: "2025-12-22T03:42:14Z"
      volumeMounts:
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-pqr28
        readOnly: true
        recursiveReadOnly: Disabled
    - image: imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend
      imageID: ""
      lastState: {}
      name: db-migrate
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          message: 'Back-off pulling image "imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend":
            ErrImagePull: [rpc error: code = NotFound desc = failed to pull and unpack
            image "imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend":
            failed to resolve reference "imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend":
            imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend:
            not found, failed to pull and unpack image "imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend":
            failed to resolve reference "imrightguycloudtolocalllm.azurecr.io/api-backend:main-1ebf1f7843b7278fc86964ccca37b9268a244160-api-backend":
            failed to authorize: failed to fetch anonymous token: unexpected status
            from GET request to https://imrightguycloudtolocalllm.azurecr.io/oauth2/token?scope=repository%3Aapi-backend%3Apull&service=imrightguycloudtolocalllm.azurecr.io:
            401 Unauthorized]'
          reason: ImagePullBackOff
      volumeMounts:
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-pqr28
        readOnly: true
        recursiveReadOnly: Disabled
    phase: Pending
    podIP: 10.244.1.135
    podIPs:
    - ip: 10.244.1.135
    qosClass: Burstable
    startTime: "2025-12-22T03:42:13Z"
- apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: "2025-12-21T18:16:53Z"
    generateName: api-backend-6965dbcc75-
    labels:
      app: api-backend
      pod-template-hash: 6965dbcc75
      tier: backend
    name: api-backend-6965dbcc75-74qqc
    namespace: cloudtolocalllm
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: api-backend-6965dbcc75
      uid: c3d0974d-aeb5-46c4-8829-20a08c1ffcd3
    resourceVersion: "8176234"
    uid: c8fb82ab-7f1f-4ca1-b4ca-73cc2c2e2b6d
  spec:
    containers:
    - env:
      - name: APP_MODE
        value: local
      - name: ENABLE_BILLING
        value: "false"
      - name: ENABLE_MULTI_TENANCY
        value: "false"
      - name: ADMIN_CENTER_ENABLED
        value: "true"
      - name: ENABLE_ADMIN_PAYMENTS
        value: "false"
      - name: NODE_ENV
        valueFrom:
          configMapKeyRef:
            key: NODE_ENV
            name: cloudtolocalllm-config
      - name: LOG_LEVEL
        valueFrom:
          configMapKeyRef:
            key: LOG_LEVEL
            name: cloudtolocalllm-config
      - name: CLIENT_LOG_DIR
        valueFrom:
          configMapKeyRef:
            key: CLIENT_LOG_DIR
            name: cloudtolocalllm-config
      - name: PORT
        valueFrom:
          configMapKeyRef:
            key: PORT
            name: cloudtolocalllm-config
      - name: DOMAIN
        valueFrom:
          configMapKeyRef:
            key: DOMAIN
            name: cloudtolocalllm-config
      - name: DB_TYPE
        valueFrom:
          configMapKeyRef:
            key: DB_TYPE
            name: cloudtolocalllm-config
      - name: DB_HOST
        valueFrom:
          configMapKeyRef:
            key: DB_HOST
            name: cloudtolocalllm-config
      - name: DB_PORT
        valueFrom:
          configMapKeyRef:
            key: DB_PORT
            name: cloudtolocalllm-config
      - name: DB_NAME
        valueFrom:
          configMapKeyRef:
            key: DB_NAME
            name: cloudtolocalllm-config
      - name: DB_USER
        valueFrom:
          secretKeyRef:
            key: postgres-user
            name: cloudtolocalllm-secrets
      - name: AUTH_DB_HOST
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_HOST
            name: cloudtolocalllm-config
      - name: AUTH_DB_PORT
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_PORT
            name: cloudtolocalllm-config
      - name: AUTH_DB_NAME
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_NAME
            name: cloudtolocalllm-config
      - name: AUTH_DB_USER
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_USER
            name: cloudtolocalllm-config
      - name: AUTH_DB_PASSWORD
        valueFrom:
          secretKeyRef:
            key: postgres-auth-password
            name: cloudtolocalllm-secrets
      - name: DB_PASSWORD
        valueFrom:
          secretKeyRef:
            key: postgres-password
            name: cloudtolocalllm-secrets
      - name: JWT_SECRET
        valueFrom:
          secretKeyRef:
            key: jwt-secret
            name: cloudtolocalllm-secrets
      - name: SUPABASE_JWT_SECRET
        valueFrom:
          secretKeyRef:
            key: supabase-jwt-secret
            name: cloudtolocalllm-secrets
      - name: SUPABASE_URL
        valueFrom:
          secretKeyRef:
            key: supabase-url
            name: cloudtolocalllm-secrets
      - name: AUTH0_ISSUER_URL
        valueFrom:
          secretKeyRef:
            key: auth0-issuer-url
            name: cloudtolocalllm-secrets
      - name: AUTH0_CLIENT_ID
        valueFrom:
          secretKeyRef:
            key: auth0-client-id
            name: cloudtolocalllm-secrets
      - name: AUTH0_CLIENT_SECRET
        valueFrom:
          secretKeyRef:
            key: auth0-client-secret
            name: cloudtolocalllm-secrets
      - name: AUTH0_AUDIENCE
        valueFrom:
          secretKeyRef:
            key: auth0-audience
            name: cloudtolocalllm-secrets
      - name: ADMIN_EMAIL
        valueFrom:
          configMapKeyRef:
            key: ADMIN_EMAIL
            name: cloudtolocalllm-config
      - name: DB_POOL_MAX
        valueFrom:
          configMapKeyRef:
            key: DB_POOL_MAX
            name: cloudtolocalllm-config
      - name: DB_POOL_IDLE_TIMEOUT
        valueFrom:
          configMapKeyRef:
            key: DB_POOL_IDLE_TIMEOUT
            name: cloudtolocalllm-config
      - name: DB_POOL_CONNECTION_TIMEOUT
        valueFrom:
          configMapKeyRef:
            key: DB_POOL_CONNECTION_TIMEOUT
            name: cloudtolocalllm-config
      - name: STRIPE_SECRET_KEY
        valueFrom:
          secretKeyRef:
            key: stripe-test-secret-key
            name: cloudtolocalllm-secrets
      - name: STRIPE_PUBLISHABLE_KEY
        valueFrom:
          secretKeyRef:
            key: stripe-test-publishable-key
            name: cloudtolocalllm-secrets
      - name: STRIPE_WEBHOOK_SECRET
        valueFrom:
          secretKeyRef:
            key: stripe-test-webhook-secret
            name: cloudtolocalllm-secrets
      - name: SENTRY_DSN
        valueFrom:
          secretKeyRef:
            key: sentry-dsn
            name: cloudtolocalllm-secrets
            optional: true
      image: imrightguycloudtolocalllm.azurecr.io/api-backend:7.10.9-202512190353-api-backend
      imagePullPolicy: Always
      livenessProbe:
        failureThreshold: 3
        httpGet:
          path: /health
          port: 8080
          scheme: HTTP
        initialDelaySeconds: 60
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 5
      name: api-backend
      ports:
      - containerPort: 8080
        name: http
        protocol: TCP
      readinessProbe:
        failureThreshold: 3
        httpGet:
          path: /health
          port: 8080
          scheme: HTTP
        initialDelaySeconds: 10
        periodSeconds: 5
        successThreshold: 1
        timeoutSeconds: 3
      resources:
        limits:
          cpu: 250m
          memory: 512Mi
        requests:
          cpu: 100m
          memory: 128Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: false
        runAsNonRoot: true
        runAsUser: 1001
      startupProbe:
        failureThreshold: 30
        httpGet:
          path: /health
          port: 8080
          scheme: HTTP
        initialDelaySeconds: 5
        periodSeconds: 5
        successThreshold: 1
        timeoutSeconds: 3
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-gmf8l
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    imagePullSecrets:
    - name: regcred
    initContainers:
    - command:
      - sh
      - -c
      - |
        until pg_isready -h postgres.cloudtolocalllm.svc.cluster.local -p 5432 -U postgres; do
          echo "Waiting for postgres..."
          sleep 2
        done
      image: postgres:16-alpine
      imagePullPolicy: IfNotPresent
      name: wait-for-postgres
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-gmf8l
        readOnly: true
    - command:
      - npm
      - run
      - db:migrate
      env:
      - name: NODE_ENV
        valueFrom:
          configMapKeyRef:
            key: NODE_ENV
            name: cloudtolocalllm-config
      - name: LOG_LEVEL
        valueFrom:
          configMapKeyRef:
            key: LOG_LEVEL
            name: cloudtolocalllm-config
      - name: CLIENT_LOG_DIR
        valueFrom:
          configMapKeyRef:
            key: CLIENT_LOG_DIR
            name: cloudtolocalllm-config
      - name: PORT
        valueFrom:
          configMapKeyRef:
            key: PORT
            name: cloudtolocalllm-config
      - name: DOMAIN
        valueFrom:
          configMapKeyRef:
            key: DOMAIN
            name: cloudtolocalllm-config
      - name: DB_TYPE
        valueFrom:
          configMapKeyRef:
            key: DB_TYPE
            name: cloudtolocalllm-config
      - name: DB_HOST
        valueFrom:
          configMapKeyRef:
            key: DB_HOST
            name: cloudtolocalllm-config
      - name: DB_PORT
        valueFrom:
          configMapKeyRef:
            key: DB_PORT
            name: cloudtolocalllm-config
      - name: DB_NAME
        valueFrom:
          configMapKeyRef:
            key: DB_NAME
            name: cloudtolocalllm-config
      - name: DB_USER
        valueFrom:
          secretKeyRef:
            key: postgres-user
            name: cloudtolocalllm-secrets
      - name: AUTH_DB_HOST
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_HOST
            name: cloudtolocalllm-config
      - name: AUTH_DB_PORT
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_PORT
            name: cloudtolocalllm-config
      - name: AUTH_DB_NAME
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_NAME
            name: cloudtolocalllm-config
      - name: AUTH_DB_USER
        valueFrom:
          configMapKeyRef:
            key: AUTH_DB_USER
            name: cloudtolocalllm-config
      - name: AUTH_DB_PASSWORD
        valueFrom:
          secretKeyRef:
            key: postgres-auth-password
            name: cloudtolocalllm-secrets
      - name: DB_PASSWORD
        valueFrom:
          secretKeyRef:
            key: postgres-password
            name: cloudtolocalllm-secrets
      - name: JWT_SECRET
        valueFrom:
          secretKeyRef:
            key: jwt-secret
            name: cloudtolocalllm-secrets
      - name: SUPABASE_JWT_SECRET
        valueFrom:
          secretKeyRef:
            key: supabase-jwt-secret
            name: cloudtolocalllm-secrets
      - name: SUPABASE_URL
        valueFrom:
          secretKeyRef:
            key: supabase-url
            name: cloudtolocalllm-secrets
      - name: AUTH0_ISSUER_URL
        valueFrom:
          secretKeyRef:
            key: auth0-issuer-url
            name: cloudtolocalllm-secrets
      - name: AUTH0_CLIENT_ID
        valueFrom:
          secretKeyRef:
            key: auth0-client-id
            name: cloudtolocalllm-secrets
      - name: AUTH0_CLIENT_SECRET
        valueFrom:
          secretKeyRef:
            key: auth0-client-secret
            name: cloudtolocalllm-secrets
      - name: AUTH0_AUDIENCE
        valueFrom:
          secretKeyRef:
            key: auth0-audience
            name: cloudtolocalllm-secrets
      - name: ADMIN_EMAIL
        valueFrom:
          configMapKeyRef:
            key: ADMIN_EMAIL
            name: cloudtolocalllm-config
      - name: DB_POOL_MAX
        valueFrom:
          configMapKeyRef:
            key: DB_POOL_MAX
            name: cloudtolocalllm-config
      - name: DB_POOL_IDLE_TIMEOUT
        valueFrom:
          configMapKeyRef:
            key: DB_POOL_IDLE_TIMEOUT
            name: cloudtolocalllm-config
      - name: DB_POOL_CONNECTION_TIMEOUT
        valueFrom:
          configMapKeyRef:
            key: DB_POOL_CONNECTION_TIMEOUT
            name: cloudtolocalllm-config
      - name: STRIPE_SECRET_KEY
        valueFrom:
          secretKeyRef:
            key: stripe-test-secret-key
            name: cloudtolocalllm-secrets
      - name: STRIPE_PUBLISHABLE_KEY
        valueFrom:
          secretKeyRef:
            key: stripe-test-publishable-key
            name: cloudtolocalllm-secrets
      - name: STRIPE_WEBHOOK_SECRET
        valueFrom:
          secretKeyRef:
            key: stripe-test-webhook-secret
            name: cloudtolocalllm-secrets
      - name: SENTRY_DSN
        valueFrom:
          secretKeyRef:
            key: sentry-dsn
            name: cloudtolocalllm-secrets
            optional: true
      image: imrightguycloudtolocalllm.azurecr.io/api-backend:7.10.9-202512190353-api-backend
      imagePullPolicy: Always
      name: db-migrate
      resources: {}
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: false
        runAsNonRoot: true
        runAsUser: 1001
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-gmf8l
        readOnly: true
    nodeName: aks-nodepool1-20736382-vmss000000
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      fsGroup: 1001
      runAsNonRoot: true
      runAsUser: 1001
    serviceAccount: api-backend-sa
    serviceAccountName: api-backend-sa
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    - effect: NoSchedule
      key: node.kubernetes.io/memory-pressure
      operator: Exists
    volumes:
    - name: kube-api-access-gmf8l
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-21T18:16:54Z"
      status: "True"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-21T18:16:59Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-24T03:45:33Z"
      message: 'containers with unready status: [api-backend]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-24T03:45:33Z"
      message: 'containers with unready status: [api-backend]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-21T18:16:53Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - containerID: containerd://cd23826eb3a7dde8105abcf65e2805aa67f8d00966c630ae111d27341fb33227
      image: imrightguycloudtolocalllm.azurecr.io/api-backend:7.10.9-202512190353-api-backend
      imageID: imrightguycloudtolocalllm.azurecr.io/api-backend@sha256:2d25b2910edbedb0b59eb66aef633af9038842c088304b6e32dfcee48196308c
      lastState:
        terminated:
          containerID: containerd://cd23826eb3a7dde8105abcf65e2805aa67f8d00966c630ae111d27341fb33227
          exitCode: 1
          finishedAt: "2025-12-24T20:42:56Z"
          reason: Error
          startedAt: "2025-12-24T20:42:39Z"
      name: api-backend
      ready: false
      restartCount: 209
      started: false
      state:
        waiting:
          message: back-off 5m0s restarting failed container=api-backend pod=api-backend-6965dbcc75-74qqc_cloudtolocalllm(c8fb82ab-7f1f-4ca1-b4ca-73cc2c2e2b6d)
          reason: CrashLoopBackOff
      volumeMounts:
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-gmf8l
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.224.0.4
    hostIPs:
    - ip: 10.224.0.4
    initContainerStatuses:
    - containerID: containerd://1bfc9092b33fb928a7a3d895a1c181280988c0c675b7a31ab993faa52448068b
      image: docker.io/library/postgres:16-alpine
      imageID: docker.io/library/postgres@sha256:6a388fba16e2a94d6d92bc3c435cdc2e20145add88547615b3d8fa545d703afe
      lastState: {}
      name: wait-for-postgres
      ready: true
      restartCount: 0
      started: false
      state:
        terminated:
          containerID: containerd://1bfc9092b33fb928a7a3d895a1c181280988c0c675b7a31ab993faa52448068b
          exitCode: 0
          finishedAt: "2025-12-21T18:16:54Z"
          reason: Completed
          startedAt: "2025-12-21T18:16:54Z"
      volumeMounts:
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-gmf8l
        readOnly: true
        recursiveReadOnly: Disabled
    - containerID: containerd://dd8a56fe7413873147a581b2b388e12387421230c3ff094fe5d8b0f5fa3d5d50
      image: imrightguycloudtolocalllm.azurecr.io/api-backend:7.10.9-202512190353-api-backend
      imageID: imrightguycloudtolocalllm.azurecr.io/api-backend@sha256:2d25b2910edbedb0b59eb66aef633af9038842c088304b6e32dfcee48196308c
      lastState: {}
      name: db-migrate
      ready: true
      restartCount: 0
      started: false
      state:
        terminated:
          containerID: containerd://dd8a56fe7413873147a581b2b388e12387421230c3ff094fe5d8b0f5fa3d5d50
          exitCode: 0
          finishedAt: "2025-12-21T18:16:58Z"
          reason: Completed
          startedAt: "2025-12-21T18:16:54Z"
      volumeMounts:
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-gmf8l
        readOnly: true
        recursiveReadOnly: Disabled
    phase: Running
    podIP: 10.244.1.114
    podIPs:
    - ip: 10.244.1.114
    qosClass: Burstable
    startTime: "2025-12-21T18:16:53Z"
kind: List
metadata:
  resourceVersion: ""
