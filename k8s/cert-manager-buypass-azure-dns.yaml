# cert-manager ClusterIssuer using Buypass Go SSL with Azure DNS-01 challenge
# ⚠️ DEPRECATED: Buypass Go SSL no longer creates new ACME accounts (as of 2024)
# See: https://community.buypass.com/t/y4y130p/buypass-terminates-issuance-of-gossl-certificates
# This file is kept for reference only - use ZeroSSL or SSL.com instead
# Buypass Go SSL offered 180-day certificates with higher rate limits than Let's Encrypt
# 
# Benefits:
# - 180-day certificate validity (vs 90 days for Let's Encrypt)
# - Higher rate limits
# - No account creation required for basic use
# - Works with existing Azure DNS setup
#
# Prerequisites:
# 1. Azure DNS zone: cloudtolocalllm.online
# 2. Service Principal with DNS Zone Contributor role on the DNS zone
# 3. Kubernetes secret: azure-dns-config (already exists from main setup)

apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: buypass-prod
spec:
  acme:
    # Buypass Go SSL ACME server
    server: https://api.buypass.com/acme/directory
    email: admin@cloudtolocalllm.online
    
    privateKeySecretRef:
      name: buypass-prod-key
    
    # Use DNS-01 challenge with Azure DNS for domain validation
    solvers:
      - dns01:
          azureDNS:
            # Azure service principal credentials from existing secret
            # The secret contains: client-id, client-secret, subscription-id, tenant-id
            clientID: <AZURE_CLIENT_ID>  # Replace in workflow or manually
            clientSecretSecretRef:
              name: azure-dns-config
              key: client-secret
            subscriptionID: <AZURE_SUBSCRIPTION_ID>  # Replace in workflow or manually
            tenantID: <AZURE_TENANT_ID>  # Replace in workflow or manually
            resourceGroupName: cloudtolocalllm-rg
            hostedZoneName: cloudtolocalllm.online
            environment: AzurePublicCloud

