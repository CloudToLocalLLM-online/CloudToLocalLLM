# cert-manager ClusterIssuer using SSL.com with Azure DNS-01 challenge
# SSL.com offers free and paid SSL certificates with ACME automation
#
# Benefits:
# - Free 90-day certificates
# - Enterprise-grade CA
# - Higher rate limits than Let's Encrypt
# - No EAB required for free tier
# - Works with existing Azure DNS setup
#
# Prerequisites:
# 1. SSL.com account: https://www.ssl.com/ (sign up for free)
# 2. Create ACME account in SSL.com dashboard
# 3. Azure DNS zone: cloudtolocalllm.online
# 4. Service Principal with DNS Zone Contributor role on the DNS zone
# 5. Kubernetes secret: azure-dns-config (already exists from main setup)

apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: sslcom-prod
spec:
  acme:
    # SSL.com ACME server (DV90 = Domain Validated, 90-day certificates)
    server: https://acme.ssl.com/sslcom-dv-rsa
    email: admin@cloudtolocalllm.online

    privateKeySecretRef:
      name: sslcom-prod-key

    # Use DNS-01 challenge with Azure DNS for domain validation
    solvers:
      - dns01:
          azureDNS:
            # Azure service principal credentials from existing secret
            # The secret contains: client-id, client-secret, subscription-id, tenant-id
            clientID: <AZURE_CLIENT_ID>  # Replace in workflow or manually
            clientSecretSecretRef:
              name: azure-dns-config
              key: client-secret
            subscriptionID: <AZURE_SUBSCRIPTION_ID>  # Replace in workflow or manually
            tenantID: <AZURE_TENANT_ID>  # Replace in workflow or manually
            resourceGroupName: cloudtolocalllm-rg
            hostedZoneName: cloudtolocalllm.online
            environment: AzurePublicCloud
