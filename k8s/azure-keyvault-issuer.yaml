# Azure Key Vault ClusterIssuer for cert-manager
# This uses Azure Key Vault as the certificate source instead of Let's Encrypt
#
# Prerequisites:
# 1. Azure Key Vault created: az keyvault create --name cloudtolocalllm-kv --resource-group cloudtolocalllm-rg
# 2. Service Principal with permissions to access Key Vault
# 3. Azure-managed certificate imported or created in Key Vault
#
# Required secrets in Kubernetes:
# - azure-keyvault-config:
#     client-id: <Azure Client ID>
#     client-secret: <Azure Client Secret>
#     tenant-id: <Azure Tenant ID>

apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: azure-keyvault-issuer
spec:
  vault:
    # Azure Key Vault endpoint
    server: https://cloudtolocalllm-kv.vault.azure.net
    path: certificates
    auth:
      azure:
        clientId: <AZURE_CLIENT_ID>
        clientSecretRef:
          name: azure-keyvault-config
          key: client-secret
        tenantId: <AZURE_TENANT_ID>

