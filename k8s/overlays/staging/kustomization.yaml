apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: cloudtolocalllm-staging

resources:
  - ../../api-backend-deployment.yaml
  - ../../web-deployment.yaml
  - ../../configmap.yaml
  - ../../secrets.yaml
  - ../../postgres-statefulset.yaml
  - ../../ingress-aws-nlb.yaml
  - ../../rbac.yaml
  - ../../network-policies.yaml

# Staging environment patches
patches:
  - path: configmap-patch.yaml
    target:
      kind: ConfigMap
      name: cloudtolocalllm-config
  - path: web-deployment-patch.yaml
    target:
      kind: Deployment
      name: web
  - path: api-backend-deployment-patch.yaml
    target:
      kind: Deployment
      name: api-backend

# Common labels for all resources
labels:
  environment: staging
  managed-by: kustomize

# Common annotations
commonAnnotations:
  environment.cloudtolocalllm.online/type: staging
  environment.cloudtolocalllm.online/cost-optimized: "true"
